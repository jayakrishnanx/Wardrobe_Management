<!DOCTYPE html>
<html>
<head>
    <title>Outfit Recommendations</title>
</head>
<body>

<h2>Get Outfit Recommendations</h2>

<!-- ðŸ”¹ FORM ALWAYS VISIBLE -->
<form method="post">
    {% csrf_token %}

    Occasion:
    <select name="occasion">
        <option value="">-- Select Occasion --</option>
        {% for o in occasions %}
            <option value="{{ o.id }}">{{ o.name }}</option>
        {% endfor %}
    </select>

    Season:
    <select name="season">
        <option value="">-- Select Season --</option>
        {% for s in seasons %}
            <option value="{{ s.id }}">{{ s.name }}</option>
        {% endfor %}
    </select>

    <button type="submit">Recommend</button>
</form>

<hr>

<h3>Recommended Outfits</h3>

{% for rec in recommendations %}
  <div style="border:1px solid #ccc; padding:10px; margin-bottom:15px;">

    <div style="display:flex; gap:30px;">

      <!-- TOP -->
      <div>
        <b>Top</b><br>
        {% if rec.top_item.image %}
          <img src="{{ rec.top_item.image.url }}" width="150">
        {% else %}
          <p>No image</p>
        {% endif %}
        <p>{{ rec.top_item.item_type }}</p>
      </div>

      <!-- BOTTOM -->
      <div>
        <b>Bottom</b><br>
        {% if rec.bottom_item.image %}
          <img src="{{ rec.bottom_item.image.url }}" width="150">
        {% else %}
          <p>No image</p>
        {% endif %}
        <p>{{ rec.bottom_item.item_type }}</p>
      </div>

    </div>

    <!-- MATCH QUALITY -->
    <p>
      <b>Match Quality:</b>
      {% if rec.match_score >= 0.85 %}
        <span style="color:green;">Excellent</span>
      {% elif rec.match_score >= 0.7 %}
        <span style="color:blue;">Good</span>
      {% elif rec.match_score >= 0.5 %}
        <span style="color:orange;">Average</span>
      {% else %}
        <span style="color:red;">Poor</span>
      {% endif %}
    </p>

    <h4>Matching Accessories</h4>
    <ul>
      {% for ar in rec.accessory_recommendations.all %}
        <li>
          {{ ar.accessory.accessory_type }} â€“
          â‚¹{{ ar.accessory.price }}

          <form method="post" action="{% url 'place_order' %}" style="display:inline;">
            {% csrf_token %}
            <input type="hidden" name="accessory_id" value="{{ ar.accessory.id }}">
            <input type="number" name="quantity" value="1" min="1">
            <button type="submit">Buy</button>
          </form>
        </li>
      {% empty %}
        <li>No accessories available.</li>
      {% endfor %}
    </ul>

  </div>
{% empty %}
  <p>No recommendations yet.</p>
{% endfor %}

</body>
</html>
